<!-- Powered by BMADâ„¢ Core -->

# Story 17.8: Task Status Tracking

## Status

Draft

## Story

**As a** connector operator running an AI agent,
**I want** task status tracking with Kind 7000 progress updates,
**So that** task requesters can monitor long-running tasks with progress indicators and ETAs.

## Acceptance Criteria

1. Emit Kind 7000 when task moves to `processing`
2. Emit Kind 7000 with progress updates for long tasks
3. Include `progress` tag (0-100) when applicable
4. Include `eta` tag (estimated seconds) when applicable
5. Track task state locally for lifecycle management
6. Configurable status update frequency

## Tasks / Subtasks

- [ ] Task 1: Define task state types (AC: 5)
  - [ ] Create `TaskState` type
  - [ ] States: queued, processing, waiting, completed, failed, cancelled

- [ ] Task 2: Implement status tracker (AC: 1, 2, 3, 4, 6)
  - [ ] Create `TaskStatusTracker` class
  - [ ] Emit Kind 7000 on state transitions
  - [ ] Add progress/eta tags
  - [ ] Configurable update frequency

- [ ] Task 3: Integration with task executor (AC: 1, 2, 5)
  - [ ] Hook into task lifecycle events
  - [ ] Automatic status emission
  - [ ] State persistence

- [ ] Task 4: Tests (AC: all)
  - [ ] Unit tests for state machine
  - [ ] Integration test with task flow

## Dev Notes

**Task States:**

- `queued`: Accepted, waiting to start
- `processing`: Currently executing
- `waiting`: Blocked on dependency
- `completed`: Success
- `failed`: Error occurred
- `cancelled`: Manually stopped

**Kind 7000 Progress:**

```json
{
  "kind": 7000,
  "tags": [
    ["e", "<task-id>"],
    ["p", "<requester>"],
    ["status", "processing"],
    ["progress", "50"],
    ["eta", "15"]
  ],
  "content": "Processing..."
}
```

[Source: docs/prd/epic-17-nip-90-dvm-compatibility.md#story-178]

---

## Change Log

| Date       | Version | Description   | Author |
| ---------- | ------- | ------------- | ------ |
| 2026-01-28 | 1.0     | Story created | SM     |

---

## Dev Agent Record

[To be filled by Dev Agent]

---

## QA Results

[To be filled by QA Agent]
